{% extends "core/base.html" %}
{% block title %}Studenten{% endblock %}
{% block header_title %}Studenten{% endblock %}

{% block content %}
<div class="card" style="margin-bottom:12px;">
    <form method="get" class="grid cols-3">
        <div>
            <label>Zoek</label>
            <input name="q" placeholder="Naam of email" value="{{ q }}">
        </div>

        <div>
            <label>Status</label>
            <select name="status">
                <option value="">Alle</option>
                <option value="pending" {% if status == "pending" %}selected{% endif %}>Nog beginnen</option>
                <option value="active" {% if status == "active" %}selected{% endif %}>Actief</option>
                <option value="dropped" {% if status == "dropped" %}selected{% endif %}>Afgevallen</option>
                <option value="completed" {% if status == "completed" %}selected{% endif %}>Afgerond</option>
            </select>
        </div>

        <div>
            <label>Locatie</label>
            <select name="location">
                <option value="">Alle</option>
                {% for l in locations %}
                <option value="{{ l.id }}" {% if location_id == l.id|stringformat:"s" %}selected{% endif %}>{{ l.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div>
            <label>Organisatie</label>
            <select name="org">
                <option value="">Alle</option>
                {% for o in orgs %}
                <option value="{{ o.id }}" {% if org_id == o.id|stringformat:"s" %}selected{% endif %}>
                    {{ o }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div>
            <label>Baangarantie</label>
            <select name="job_guarantee">
                <option value="">Alle</option>
                <option value="1" {% if job_guarantee == "1" %}selected{% endif %}>Ja</option>
                <option value="0" {% if job_guarantee == "0" %}selected{% endif %}>Nee</option>
            </select>
        </div>

        <div>
            <label>Praktijkroute</label>
            <select name="praktijkroute">
                <option value="">Alle</option>
                <option value="1" {% if praktijkroute == "1" %}selected{% endif %}>Ja</option>
                <option value="0" {% if praktijkroute == "0" %}selected{% endif %}>Nee</option>
            </select>
        </div>

        <div style="display:flex; gap:10px; align-items:flex-end;">
            <button class="btn" type="submit">Filter</button>
            <a class="btn btn-ghost" href="{% url 'student_list' %}">Reset</a>
        </div>
    </form>
</div>

<div class="card">
    <table>
        <thead>
            <tr>
                <th>Naam</th>
                <th>Status</th>
                <th>Locatie</th>
                <th>Organisatie</th>
                <th>Baangarantie</th>
                <th>Praktijkroute</th>
                <th>Meldingen</th>
            </tr>
        </thead>
        <tbody>
            {% for s in students %}
            <tr>
                <td><a href="{% url 'student_detail' s.id %}">{{ s.last_name }}, {{ s.first_name }}</a></td>
                <td><a href="{% url 'student_detail' s.id %}">{{ s.student_profile.get_status_display }}</a></td>
                <td><a href="{% url 'student_detail' s.id %}">{{ s.student_profile.location }}</a></td>
                <td><a href="{% url 'student_detail' s.id %}">{{ s.student_profile.organization }}</a></td>
                <td><a href="{% url 'student_detail' s.id %}">{{ s.student_profile.job_guarantee|yesno:"Ja,Nee" }}</a></td>
                <td><a href="{% url 'student_detail' s.id %}">{{ s.student_profile.praktijkroute|yesno:"Ja,Nee" }}</a></td>
                <td><a href="{% url 'student_detail' s.id %}?tab=signals">{{ s.signals.count }}</a></td>
            </tr>
            {% empty %}
            <tr><td colspan="6" class="muted">Geen studenten gevonden.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
